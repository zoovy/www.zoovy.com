#!/usr/bin/perl

use lib "/httpd/modules";

use CGI;

$/ = undef;
my $xml = <STDIN>;
$/ = "\n";



my $METHOD = $ENV{'REQUEST_METHOD'};


if ($METHOD eq 'OPTIONS') {
	print "DAV: 1\n";
	print qq~Content-type: text/xml; charset="utf8"\n\n~;
	}
elsif ($METHOD eq 'PROPFIND') {
	print "DAV: 1\n";
	print qq~Content-type: text/xml; charset="utf8"\n\n~;
#	print qq~<?xml version="1.0" encoding="utf-8" ?><D:propfind xmlns:D="DAV:" xmlns:E="http://www.foo.bar/standards/props/"></D:propfind>~;
	print qq~
   <D:multistatus xmlns:D="DAV:">
     <D:response>
          <D:href>http://www.foo.bar/file</D:href>
          <D:propstat>
               <D:prop xmlns:R="http://www.foo.bar/boxschema/">
                    <R:bigbox>
                         <R:BoxType>Box type A</R:BoxType>
                    </R:bigbox>
                    <R:author>
                         <R:Name>J.J. Johnson</R:Name>
                    </R:author>
               </D:prop>
               <D:status>HTTP/1.1 200 OK</D:status>
          </D:propstat>
          <D:propstat>
               <D:prop><R:DingALing/><R:Random/></D:prop>
               <D:status>HTTP/1.1 403 Forbidden</D:status>
               <D:responsedescription> The user does not have access to the DingALing property.
               </D:responsedescription>
          </D:propstat>
     </D:response>
     <D:responsedescription> There has been an access violation error.
     </D:responsedescription>
   </D:multistatus>
	~;


	}

use Data::Dumper;
print STDERR Dumper(\%ENV,$xml);
